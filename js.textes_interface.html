[(#HTTP_HEADER{Content-type: text/javascript[; charset=(#CHARSET)]})]

[(#SET{lalangue,[(#ENV{lang}|sinon{#VAL|detecter_langue_visiteur})]})]
// [(#GET{lalangue}|lang_select)]

[(#ENV{lang}|non)
	[(#GET{lalangue}|=={fr}|non)
		var action = $("#formulaire_login").attr("action");
		$("#interface_connexion").load("index.php?page=pave_connexion&lang=[(#GET{lalangue})]", function() {
			$("#formulaire_login").attr("action", action);
		});
		language = "[(#GET{lalangue})]";
	]
]
	function plier_messages() {
		if ($("body").hasClass("plier")) {
			$("ul.reponses").each(function() {
				var total = 0;
				var i = 0;
				
				$(this).children("li.lienshow").remove();
				$(this).children("li.reponse").each(function() { total ++; });
				
				if (total > 3) {
					var max = total - 2;
					$(this).children("li.reponse").each(function() {
						if (i < max) {
							i ++;
							$(this).addClass("masquer");
						}
					});
					$(this).prepend("<li class='reponse lienshow' onclick=\"$(this).afficher_masques();\">"+ traductionSeenThis.montrer_messages.replace("@total@", total) +"</li>");
				}
			});
		}
	}



function afficher_textes_traduits_une_fois() {
	$('#entete .accueil a').html(traductionSeenThis.texte_accueil);
	$('#entete .people a.intitule').html(traductionSeenThis.texte_people);
	$('#entete .tags a.intitule').html(traductionSeenThis.texte_tags);
	$('#entete .urls a.intitule').html(traductionSeenThis.texte_urls);
	$('#entete .profile a.intitule').html(traductionSeenThis.texte_profil);
	$('#entete .logout a.intitule').html(traductionSeenThis.texte_logout);

	$('.vous_suivez').html(traductionSeenThis.texte_abonnements);
	$('.vous_suivent').html(traductionSeenThis.texte_abonnes);
	$('.votre_message_public').html(traductionSeenThis.votre_message_public);

	$('h1.auteurs_vous_suivez').html(traductionSeenThis.texte_auteurs_vous_suivez);
	$('h1.themes_vous_suivez').html(traductionSeenThis.texte_themes_vous_suivez);
	$('h1.urls_vous_suivez').html(traductionSeenThis.texte_urls_vous_suivez);
	$('.bouton_suggerer').html(traductionSeenThis.me_suggerer_contacts);
	$('.beta_publique').html(traductionSeenThis.beta_publique);
	$('#pave_accueil .interne').html(traductionSeenThis.pave_accueil);
	$('.slogan_texte').html(traductionSeenThis.slogan_texte);
	$('.slogan_lien').html(traductionSeenThis.slogan_lien);

	$('#theme_manuellement').html(traductionSeenThis.theme_manuellement);
	$('#theme_automatiquement').html(traductionSeenThis.theme_automatiquement);


	$('.bookmarklet_titre').html(traductionSeenThis.bookmarklet_titre);
	$('.bookmarklet_descriptif').html(traductionSeenThis.bookmarklet_descriptif);
	
	plier_messages();
}


function afficher_textes_traduits() {
	$('.modifier a').html(traductionSeenThis.texte_modifier);
	$('.modifier_themes').html(traductionSeenThis.texte_modifier);
	$('.supprimer a').html(traductionSeenThis.texte_effacer);
	$('.texte_afficher_themes').html(traductionSeenThis.themes_automatiques);
	$('.txt_favori').html(traductionSeenThis.texte_favori);
	$('.bouton_repondre a').html(traductionSeenThis.texte_bouton_reponse);
	$('.votre_message').html(traductionSeenThis.votre_message);
	$('.formulaire_poster_message input[type=submit]').attr('value', traductionSeenThis.envoyer_message);
	if (!$('#formulaire_inscription .message_inscription').length) {
		$('#formulaire_inscription').prepend('<div class="message_inscription">' + traductionSeenThis.message_inscription + '</div>');
	}

	$('.raccourci_quote').html(traductionSeenThis.raccourci_quote);
	$('.raccourci_italic').html(traductionSeenThis.raccourci_italic);
	$('.raccourci_bold').html(traductionSeenThis.raccourci_bold);
	$('.intitule_connexion').html(traductionSeenThis.intitule_connexion);
}

var traductionSeenThis = {
	texte_modifier: '<:seenthis:modifier|texte_script:>',
	texte_effacer: '<:seenthis:effacer|texte_script:>',
	texte_favori: '<:seenthis:favori|texte_script:>',
	texte_urls: '<:seenthis:urls|texte_script:>',
	texte_bouton_reponse: '<:seenthis:ecrire_commentaire|texte_script:>',

	raccourci_quote: '<:seenthis:raccourci_quote|texte_script:>',
	raccourci_italic: '<:seenthis:raccourci_italic|texte_script:>',
	raccourci_bold: '<:seenthis:raccourci_bold|texte_script:>',

	envoyer_message: '<:seenthis:envoyer|texte_script:>',
	votre_message: '<:seenthis:votre_message|texte_script:>',
	votre_message_public: '<:seenthis:votre_message_public|texte_script:>',

	texte_accueil : '<:seenthis:accueil|texte_script:>',
	texte_people : '<:seenthis:people|texte_script:>',
	texte_tags : '<:seenthis:tags|texte_script:>',
	texte_profil : '<:seenthis:profil|texte_script:>',
	beta_publique : '<:seenthis:beta_publique|texte_script:>',
	pave_accueil : '<:seenthis:pave_accueil|texte_script:>',
	themes_automatiques : '<:seenthis:themes_automatiques|texte_script:>',
	intitule_connexion : '<:seenthis:intitule_connexion|texte_script:>',

	texte_logout : '<:seenthis:logout|texte_script:>',
	texte_abonnements: '<:seenthis:vous_suivez|texte_script:>',
	texte_abonnes: '<:seenthis:vous_suivent|texte_script:>',
	me_suggerer_contacts: '<:seenthis:me_suggerer_contacts|texte_script:>',

	texte_auteurs_vous_suivez: '<:seenthis:auteurs_vous_suivez|texte_script:>',
	texte_themes_vous_suivez: '<:seenthis:themes_vous_suivez|texte_script:>',
	texte_urls_vous_suivez: '<:seenthis:urls_vous_suivez|texte_script:>',

	slogan_texte: '<:seenthis:slogan_texte|texte_script:>',
	slogan_lien: '<:seenthis:slogan_lien|texte_script:>',
	message_inscription: '<:seenthis:message_inscription|texte_script:>',

	theme_manuellement: '<:seenthis:theme_manuellement|texte_script:>',
	theme_automatiquement: '<:seenthis:theme_automatiquement|texte_script:>',


	traduire_avec_google: '<:seenthis:traduire_avec_google|texte_script:>',

	bookmarklet_titre: '<:seenthis:bookmarklet_titre|texte_script:>',
	bookmarklet_descriptif: '<:seenthis:bookmarklet_descriptif|texte_script:>',

	montrer_messages: '<:seenthis:montrer_messages|texte_script:>'
};

afficher_textes_traduits_une_fois();


if (auteur_page > 0) {
	$("#charger_pave_inscription").load("index.php?page=pave_inscription&lang=[(#GET{lalangue})]&auteur_page="+auteur_page);
} else {
	$("#charger_pave_inscription").load("index.php?page=pave_inscription&lang=[(#GET{lalangue})]");
}

afficher_traduire();

$(document).ajaxComplete(function(e, xhr, settings){
	afficher_traduire();
	afficher_textes_traduits();
});

